2021-07-21T15:03:31|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\hardware.py", line 208, in enable_connection
    raise err
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\hardware.py", line 204, in enable_connection
    self.connect()
  File "C:\LabPrograms\Python\OBIS_ScopeFoundry\laser_hardware.py", line 35, in connect
    self.laser = LaserDevice(port=self.port.val, debug=self.debug_mode.val)
  File "C:\LabPrograms\Python\OBIS_ScopeFoundry\laser_device.py", line 14, in __init__
    self.ser = ser = serial.Serial(port=self.port, baudrate=921600,
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\serial\serialwin32.py", line 31, in __init__
    super(Serial, self).__init__(*args, **kwargs)
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\serial\serialutil.py", line 240, in __init__
    self.open()
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\serial\serialwin32.py", line 62, in open
    raise SerialException("could not open port {!r}: {!r}".format(self.portstr, ctypes.WinError()))
serial.serialutil.SerialException: could not open port 'COM7': FileNotFoundError(2, 'Impossibile trovare il file specificato.', None, 2)

2021-07-21T15:04:11|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 244, in start_stop
    self._start()
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 134, in _start
    raise RuntimeError("Cannot start a new measurement while still measuring")
RuntimeError: Cannot start a new measurement while still measuring

2021-07-21T15:04:22|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\LabPrograms\Python\PROCHIP_Microscope\PROCHIP_Measurement_SIM.py", line 159, in run
    self.start_triggered_Acquisition(freq1)
  File "C:\LabPrograms\Python\PROCHIP_Microscope\PROCHIP_Measurement_SIM.py", line 431, in start_triggered_Acquisition
    self.start_laser_CW(self.laser_0)
  File "C:\LabPrograms\Python\PROCHIP_Microscope\PROCHIP_Measurement_SIM.py", line 367, in start_laser_CW
    laserHW.read_from_hardware()
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\hardware.py", line 181, in read_from_hardware
    lq.read_from_hardware()
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\logged_quantity.py", line 161, in read_from_hardware
    val = self.hardware_read_func()
  File "C:\LabPrograms\Python\OBIS_ScopeFoundry\laser_device.py", line 60, in get_model
    fullresp = self.write_cmd('SYSTem1:INFormation:MODel?')
  File "C:\LabPrograms\Python\OBIS_ScopeFoundry\laser_device.py", line 26, in write_cmd
    echo = self.ser.readline()
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\serial\serialwin32.py", line 269, in read
    win32.ResetEvent(self._overlapped_read.hEvent)
AttributeError: 'NoneType' object has no attribute 'hEvent'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 25, in run
    self.measurement._thread_run()
  File "C:\Users\Admin\anaconda3\envs\scopefoundry\lib\site-packages\ScopeFoundry\measurement.py", line 179, in _thread_run
    self.run()
  File "C:\LabPrograms\Python\PROCHIP_Microscope\PROCHIP_Measurement_SIM.py", line 275, in run
    self.stop_triggered_Acquisition()
  File "C:\LabPrograms\Python\PROCHIP_Microscope\PROCHIP_Measurement_SIM.py", line 463, in stop_triggered_Acquisition
    self.camera.hamamatsu.stopAcquisition()
AttributeError: 'HamamatsuHardware' object has no attribute 'hamamatsu'

2021-07-21T17:18:49|ERROR|PROCHIP_SIM_Measurement|PROCHIP_SIM Failed to update figure1: <class 'PyQt5.QtGui.QKeyEvent'> returned a result with an error set. ['Traceback (most recent call last):\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\logged_quantity.py", line 241, in update_value\n    self.hardware_set_func(self.val)\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 168, in set_laser_power\n    fullresp = self.write_cmd(\'SOURce:POWer:LEVel:IMMediate:AMPLitude \'+str(value/1000))\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 25, in write_cmd\n    self.ser.write(serialcmd.encode())\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\serial\\serialwin32.py", line 323, in write\n    raise writeTimeoutError\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 25, in run\n    self.measurement._thread_run()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 179, in _thread_run\n    self.run()\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 275, in run\n    self.stop_triggered_Acquisition()\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 456, in stop_triggered_Acquisition\n    self.stop_laser(self.laser_0)\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 372, in stop_laser\n    laserHW.read_from_hardware()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\hardware.py", line 181, in read_from_hardware\n    lq.read_from_hardware()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\logged_quantity.py", line 161, in read_from_hardware\n    val = self.hardware_read_func()\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 60, in get_model\n    fullresp = self.write_cmd(\'SYSTem1:INFormation:MODel?\')\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 25, in write_cmd\n    self.ser.write(serialcmd.encode())\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\serial\\serialwin32.py", line 323, in write\n    raise writeTimeoutError\n', 'serial.serialutil.SerialTimeoutException: Write timeout\n', '\nThe above exception was the direct cause of the following exception:\n\n', 'Traceback (most recent call last):\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 273, in _on_display_update_timer\n    self.update_display()\n', "SystemError: <class 'PyQt5.QtGui.QKeyEvent'> returned a result with an error set\n"]
2021-07-21T17:20:13|ERROR|PROCHIP_SIM_Measurement|PROCHIP_SIM Failed to update figure1: <class 'PyQt5.QtGui.QKeyEvent'> returned a result with an error set. ['Traceback (most recent call last):\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\logged_quantity.py", line 241, in update_value\n    self.hardware_set_func(self.val)\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 168, in set_laser_power\n    fullresp = self.write_cmd(\'SOURce:POWer:LEVel:IMMediate:AMPLitude \'+str(value/1000))\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 25, in write_cmd\n    self.ser.write(serialcmd.encode())\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\serial\\serialwin32.py", line 323, in write\n    raise writeTimeoutError\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 25, in run\n    self.measurement._thread_run()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 179, in _thread_run\n    self.run()\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 275, in run\n    self.stop_triggered_Acquisition()\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 456, in stop_triggered_Acquisition\n    self.stop_laser(self.laser_0)\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 372, in stop_laser\n    laserHW.read_from_hardware()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\hardware.py", line 181, in read_from_hardware\n    lq.read_from_hardware()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\logged_quantity.py", line 161, in read_from_hardware\n    val = self.hardware_read_func()\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 60, in get_model\n    fullresp = self.write_cmd(\'SYSTem1:INFormation:MODel?\')\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 25, in write_cmd\n    self.ser.write(serialcmd.encode())\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\serial\\serialwin32.py", line 323, in write\n    raise writeTimeoutError\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\logged_quantity.py", line 241, in update_value\n    self.hardware_set_func(self.val)\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 168, in set_laser_power\n    fullresp = self.write_cmd(\'SOURce:POWer:LEVel:IMMediate:AMPLitude \'+str(value/1000))\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 25, in write_cmd\n    self.ser.write(serialcmd.encode())\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\serial\\serialwin32.py", line 323, in write\n    raise writeTimeoutError\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 25, in run\n    self.measurement._thread_run()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 179, in _thread_run\n    self.run()\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 275, in run\n    self.stop_triggered_Acquisition()\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 456, in stop_triggered_Acquisition\n    self.stop_laser(self.laser_0)\n', '  File "C:\\LabPrograms\\Python\\PROCHIP_Microscope\\PROCHIP_Measurement_SIM.py", line 372, in stop_laser\n    laserHW.read_from_hardware()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\hardware.py", line 181, in read_from_hardware\n    lq.read_from_hardware()\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\logged_quantity.py", line 161, in read_from_hardware\n    val = self.hardware_read_func()\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 60, in get_model\n    fullresp = self.write_cmd(\'SYSTem1:INFormation:MODel?\')\n', '  File "C:\\LabPrograms\\Python\\OBIS_ScopeFoundry\\laser_device.py", line 25, in write_cmd\n    self.ser.write(serialcmd.encode())\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\serial\\serialwin32.py", line 323, in write\n    raise writeTimeoutError\n', 'serial.serialutil.SerialTimeoutException: Write timeout\n', '\nThe above exception was the direct cause of the following exception:\n\n', 'Traceback (most recent call last):\n', '  File "C:\\Users\\Admin\\anaconda3\\envs\\scopefoundry\\lib\\site-packages\\ScopeFoundry\\measurement.py", line 273, in _on_display_update_timer\n    self.update_display()\n', "SystemError: <class 'PyQt5.QtGui.QKeyEvent'> returned a result with an error set\n"]
